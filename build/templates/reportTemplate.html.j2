<!DOCTYPE html>
<html lang="en">
   <head>
      <link href="./static/style.css" rel="stylesheet">
      <link href="./static/bootstrap-theme.min.css" rel="stylesheet">
      <link href="https://fonts.googleapis.com/css?family=Noto+Sans" rel="stylesheet">
      <title>Report generated on {{ datetime }}</title>
   </head>
   <body>
      <header class="header">
         <nav class="navbar navbar-expand-lg navbar-dark">
            <!-- Navbar content -->
            <div class="container">
               <a class="navbar-brand" href="https://www2.gov.bc.ca">
                  <img class="img-fluid d-none d-md-block" src="https://developer.gov.bc.ca/static/BCID_H_rgb_rev-20eebe74aef7d92e02732a18b6aa6bbb.svg" width="177" height="44" alt="B.C. Government Logo">
               </a>
               <div class="navbar-brand">
                  {{ namespace }} OpenShift Config Check
               </div>
            </div>
         </nav>
      </header>
      <main role="main">
         <div class="container">
            <h2>Config assessment report for the namespace {{ namespace }} in cluster {{ clusterName }}</h2>
            <div class="report-explanation">
               <p>The AppAssessment tool assesses configuration of pods within a specific Openshift namespace and identifies the misconfigured 
               or missing settings based on what is considered best practices by RedHat and the Platform Services Team.
               Checks are performed through the calls to Openshift API, and compared to expected values. Documentation on application health 
               checks can be found <a href="https://docs.openshift.com/container-platform/4.9/applications/application-health.html">here</a>. 
               If your team is aware of additional checks that can be added to the list, please, ping us in #devops-operations channel in 
               Rocketchat. Configuring applications pods in acccordance with best practices improves the resiliency, performance and security 
               posture of the application.</p>

               <strong>Note: The report produced by the AppAssessment tool provides recommendations only, it is the responsibility of the product team to review the recommendations and implement as necessary.</strong>
            </div>
            <hr>
            <div>
               <div class="table-legend">
                  <h3>Legend</h3>
                  <table>
                     <tr>
                        <td>
                           <div class="status-icon pass">
                              &#10004
                           </div>
                        </td>
                        <td>
                           Setting is applicable and is correct
                        </td>
                     </tr>
                     <tr>
                        <td>
                           <div class="status-icon warning">
                              !
                           </div>
                        </td>
                        <td>
                           Setting may or may not be applicable, or the value may or may not be correct. Refer to documentation for more detail.
                        </td>
                     </tr>
                     <tr>
                        <td>
                           <div class="status-icon fail">
                              X
                           </div>
                        </td>
                        <td>
                           Either inapplicable or incorrect
                        </td>
                     </tr>
                     <tr>
                        <td>
                           N/A
                        </td>
                        <td>
                           Setting is not applicable for this deployment type
                        </td>
                     </tr>
                  </table>
               </div>
            </div>
            <hr/>
            <h3>Details</h3>
            <div id="quick-links">
            Jump to: 
            {% for workloadName in workloadNames %}
               <a href="#{{ workloadName }}">{{ workloadName }} </a>
            {% endfor %}
            </div>
            {% for workloadName in workloadNames %} 
            <table class="table-bordered" id="{{ workloadName }}">
               <tr>
                  <td>
                     <h4>Config Setting</h4>
                  </td>
                  <td>
                     <h4>{{ workloadName }}</h4>
                  </td>
               </tr>
               {% for checkName in results.keys() %} 
               <tr>
                  <td>
                     <a target="_blank" title="{{ checksInfo[checkName].title }}" href="{{ checksInfo[checkName].href }}"> {{ checkName }}</a>
                  </td>
                  <td>
                     <div class="check-details">
                        {% if results[checkName][workloadName]['status'] == 'fail' %}
                        <div class="status-icon fail">
                           X
                        </div>
                        {% elif results[checkName][workloadName]['status'] == 'warning' %}
                        <div class="status-icon warning">
                           !
                        </div>
                        {% elif results[checkName][workloadName]['status'] == 'pass' %}
                        <div class="status-icon pass">
                           &#10004
                        </div>
                        {% else %}
                        N/A
                        {% endif %}
                        <div class="check-detail"a>{{ results[checkName][workloadName]['text'] }}</div>
                     </div>
                  </td>
               </tr>
               {% endfor %}
            </table>
            <hr/>
            {% endfor %} 
         </div>
      </main>
      <footer class="footer">
         <nav class="navbar navbar-expand-lg navbar-dark">
            <div class="container">
               <ul class="navbar-nav">
                  <li class="nav-item">
                     <a class="nav-link" href="https://www2.gov.bc.ca/gov/content?id=79F93E018712422FBC8E674A67A70535" target="_blank">Disclaimer</a>
                  </li>
                  <li class="nav-item">
                     <a class="nav-link" href="https://www2.gov.bc.ca/gov/content?id=9E890E16955E4FF4BF3B0E07B4722932" target="_blank">Privacy</a>
                  </li>
                  <li class="nav-item">
                     <a class="nav-link" href="https://www2.gov.bc.ca/gov/content?id=E08E79740F9C41B9B0C484685CC5E412" target="_blank">Accessibility</a>
                  </li>
                  <li class="nav-item">
                     <a class="nav-link" href="https://www2.gov.bc.ca/gov/content?id=1AAACC9C65754E4D89A118B875E0FBDA" target="_blank">Copyright</a>
                  </li>
                  <li class="nav-item">
                     <a class="nav-link" href="https://www2.gov.bc.ca/gov/content?id=6A77C17D0CCB48F897F8598CCC019111" target="_blank">Contact Us</a>
                  </li>
               </ul>
            </div>
         </nav>
      </footer>
   </body>
</html>
